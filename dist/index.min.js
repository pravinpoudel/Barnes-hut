"use strict";function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Node=function t(e,n,i){_classCallCheck(this,t),this.index=e,this.x=n,this.y=i,ctx.beginPath(),ctx.strokeStyle="#FF0000",ctx.rect(n,i,1,1),ctx.stroke()},Rectangle=function(){function s(t,e,n,i){_classCallCheck(this,s),this.x=t,this.y=e,this.w=n,this.h=i,ctx.beginPath(),ctx.strokeStyle="#000000",ctx.rect(t-n,e-i,2*n,2*i),ctx.stroke()}return _createClass(s,[{key:"bound",value:function(t){return this.x+this.w==WIDTH?t.x>=this.x-this.w&&t.x<=this.x+this.w&&t.y>=this.y-this.h&&t.y<this.y+this.h:this.y+this.h==HEIGHT?t.x>=this.x-this.w&&t.x<this.x+this.w&&t.y>=this.y-this.h&&t.y<=this.y+this.h:t.x>=this.x-this.w&&t.x<this.x+this.w&&t.y>=this.y-this.h&&t.y<this.y+this.h}}]),s}(),Quadtree=function(){function h(t){_classCallCheck(this,h),this.boundary=t,this.CoM={x:null,y:null},this.mass=0,this.NE=null,this.NW=null,this.SE=null,this.SW=null,this.isDivided=!1,this.nodes=[]}return _createClass(h,[{key:"partition",value:function(){var t=this.boundary.x,e=this.boundary.y,n=this.boundary.w,i=this.boundary.h,s=new Rectangle(t+n/2,e+i/2,n/2,i/2),a=new Rectangle(t-n/2,e+i/2,n/2,i/2),o=new Rectangle(t+n/2,e-i/2,n/2,i/2),r=new Rectangle(t-n/2,e-i/2,n/2,i/2);this.NW=new h(r),this.NE=new h(o),this.SW=new h(a),this.SE=new h(s),this.isDivided=!0}},{key:"insert",value:function(t){if(!this.boundary.bound(t))return!1;if(this.nodes.length<1&&!this.isDivided)return this.mass++,this.CoM={x:t.x,y:t.y},this.nodes.push(t),!0;if(!this.isDivided){this.partition(),this.isDivided=!0;var e=this.nodes[0];this.nodes=[],this.mass=0,this.NW.insert(e)||this.NE.insert(e)||this.SW.insert(e)||this.SE.insert(e)}var n=this.mass*this.CoM.x+t.x,i=this.mass*this.CoM.y+t.y;return this.mass++,this.CoM.x=n/this.mass,this.CoM.y=i/this.mass,this.NW.insert(t)||this.NE.insert(t)||this.SW.insert(t)||this.SE.insert(t)}}]),h}();function findMaxRange(t){for(var e,n,i=-1/0,s=-1/0,a=1/0,o=1/0,r=0;r<t.length;r++)isNaN(e=+t[r].x)&&isNaN(n=+t[r].y)?console.warn("position of point at index ".concat(r," is not valid number")):(i<e&&(i=e),e<a&&(a=e),s<n&&(s=n),n<o&&(o=n))}function distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function calRepDisplacement(t,e,n){var i={},s=distance(t,e),a=kSquare/s;return i.x=(t.x-e.x)/s*a*n,i.y=(t.y-e.y)/s*a*n,i}function sleep(e){return new Promise(function(t){return setTimeout(t,e)})}var myCanvas=document.getElementById("draw"),ctx=myCanvas.getContext("2d"),WIDTH=1024,HEIGHT=900,boundary=new Rectangle(WIDTH/2,HEIGHT/2,WIDTH/2,HEIGHT/2),qt=new Quadtree(boundary),nodes=[],nodes2=[];function initializeNodesRandomly(t){nodes=[],nodes2=[];for(var e=0;e<t;e++){var n=new Node(e,Math.floor(Math.random()*WIDTH),Math.floor(Math.random()*HEIGHT));nodes.push(n),nodes2.push(n)}}var theta=.45,k=50,kSquare=Math.pow(k,2),iterationCount=2,count=function(){var e,n,i,s,a;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(0<iterationCount)return t.next=3,regeneratorRuntime.awrap(sleep(1e3));t.next=17;break;case 3:for(iterationCount--,ctx.clearRect(0,0,myCanvas.width,myCanvas.height),e=new Rectangle(WIDTH/2,HEIGHT/2,WIDTH/2,HEIGHT/2),qt=new Quadtree(e),initializeNodesRandomly(1e3),console.time("brute force time "+iterationCount),n=0;n<nodes2.length;n++)for(nodes2[n].displacement={x:0,y:0},i=0;i<nodes2.length;i++)n!=i&&(s=calRepDisplacement(nodes2[n],nodes2[i],1),nodes2[n].displacement.x+=s.x,nodes2[n].displacement.y+=s.y);console.timeEnd("brute force time "+iterationCount),a=function(){for(var t=0;t<nodes.length;t++)qt.insert(nodes[t]);console.log(qt);for(var e=0;e<nodes.length;e++){var n=nodes[e];n.displacement={x:0,y:0};var i=[];for(i.push(qt);0<i.length;){var s=i.pop(),a=s.mass;if(0!=a){var o=s.nodes,r=s.CoM;if(1!=a){if(2*s.boundary.w/distance(n,r)<theta){var h=calRepDisplacement(n,r,a);n.displacement.x+=h.x,n.displacement.y+=h.y}else{var c=s.NE,l=s.NW,u=s.SW,d=s.SE;i.push(c,l,u,d)}}else{var y=!0;if(0<o.length&&(y=o[0].index!=n.index),y&&1e-4<distance(n,r)){var x=calRepDisplacement(n,r,a);n.displacement.x+=x.x,n.displacement.y+=x.y}}}}}},console.time("BH time"+iterationCount),a(),console.timeEnd("BH time"+iterationCount),t.next=0;break;case 17:case"end":return t.stop()}})};console.log("hi"),count();
//# sourceMappingURL=index.min.js.map
